/**
 * JavaScript for YouTube player with timestamp support
 *
 * @module     assignsubmission_ytsubmission/ytsubmission_player
 * @copyright  2025 Mathieu Pelletier <mathieu@sats.ac.za>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("assignsubmission_ytsubmission/ytsubmission_player",["jquery","core/log"],(function($,Log){var player=null,videoId=null,timestamps=[],initPlayer=function(){try{if(!document.getElementById("ytsubmission-player-"+videoId))return void Log.debug("YouTube player element not found");if(void 0===window.YT||void 0===window.YT.Player)return Log.debug("YouTube API not yet loaded, waiting..."),void setTimeout(initPlayer,100);player=new window.YT.Player("ytsubmission-player-"+videoId,{events:{onReady:onPlayerReady,onError:onPlayerError}})}catch(error){Log.error("Error initializing YouTube player: "+error.message)}},onPlayerReady=function(){Log.debug("YouTube player ready")},onPlayerError=function(event){Log.error("YouTube player error: "+event.data)},setupTimestampControls=function(){var addTimestampBtn=$("#add-timestamp-btn");0!==addTimestampBtn.length&&addTimestampBtn.on("click",(function(){try{if(!player||"function"!=typeof player.getCurrentTime)return void Log.error("Player not ready");var currentTime=Math.floor(player.getCurrentTime()),timestamp={time:currentTime,formattedTime:formatTime(currentTime),note:""};timestamps.push(timestamp),renderTimestamp(timestamp,timestamps.length-1)}catch(error){Log.error("Error adding timestamp: "+error.message)}}))},formatTime=function(seconds){var hours=Math.floor(seconds/3600),minutes=Math.floor(seconds%3600/60),secs=seconds%60;return hours>0?hours+":"+pad(minutes)+":"+pad(secs):minutes+":"+pad(secs)},pad=function(num){return(num<10?"0":"")+num},renderTimestamp=function(timestamp,index){var timestampList=$("#timestamp-list"),timestampHtml='<div class="timestamp-item" data-index="'+index+'" data-time="'+timestamp.time+'"><span class="timestamp-time">'+timestamp.formattedTime+'</span><input type="text" class="timestamp-note-input form-control" placeholder="Add feedback note..." style="display: inline-block; width: 70%; margin-left: 10px;" /><button class="btn btn-sm btn-danger delete-timestamp" style="margin-left: 10px;">Delete</button></div>',$timestampItem=$(timestampHtml);timestampList.append($timestampItem),$timestampItem.find(".timestamp-time").on("click",(function(){try{player&&"function"==typeof player.seekTo&&(player.seekTo(timestamp.time,!0),player.playVideo())}catch(error){Log.error("Error seeking video: "+error.message)}})),$timestampItem.find(".timestamp-note-input").on("change",(function(){timestamps[index].note=$(this).val(),Log.debug("Timestamp note updated: "+timestamps[index].note)})),$timestampItem.find(".delete-timestamp").on("click",(function(){timestamps.splice(index,1),$timestampItem.remove(),renderAllTimestamps()}))},renderAllTimestamps=function(){$("#timestamp-list").empty(),timestamps.forEach((function(timestamp,index){renderTimestamp(timestamp,index)}))};return{init:function(vid){if(videoId=vid,void 0===window.YT||void 0===window.YT.Player){var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag),window.onYouTubeIframeAPIReady=function(){initPlayer()}}else initPlayer();setupTimestampControls()},getTimestamps:function(){return timestamps}}}));

//# sourceMappingURL=ytsubmission_player.min.js.map